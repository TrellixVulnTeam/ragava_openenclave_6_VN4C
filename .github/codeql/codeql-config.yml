#
# Refer:
# https://docs.github.com/en/free-pro-team@latest/github/finding-security-vulnerabilities-and-errors-in-your-code/configuring-code-scanning
#
name: "CodeQL config"
disable-default-queries: true

queries: 
  # Secuirty Issues
  - uses: "github/codeql/cpp/ql/src/Security/CWE/CWE-120/BadlyBoundedWrite.ql@main"
  - uses: "github/codeql/cpp/ql/src/Security/CWE/CWE-120/OverrunWrite.ql@main"
  - uses: "github/codeql/cpp/ql/src/Security/CWE/CWE-120/OverrunWriteFloat.ql@main"
  - uses: "github/codeql/cpp/ql/src/Security/CWE/CWE-120/UnboundedWrite.ql@main"
  - uses: "github/codeql/cpp/ql/src/Security/CWE/CWE-121/UnterminatedVarargsCall.ql@main"
  - uses: "github/codeql/cpp/ql/src/Security/CWE/CWE-129/ImproperArrayIndexValidation.ql@main"
  - uses: "github/codeql/cpp/ql/src/Security/CWE/CWE-131/NoSpaceForZeroTerminator.ql@main"
  - uses: "github/codeql/cpp/ql/src/Security/CWE/CWE-170/ImproperNullTerminationTainted.ql@main"
  - uses: "github/codeql/cpp/ql/src/Security/CWE/CWE-807/TaintedCondition.ql@main"
  # Buffer Handling Issues
  - uses: "github/codeql/cpp/ql/src/Critical/UseAfterFree.ql@main"
  - uses: "github/codeql/cpp/ql/src/Critical/SizeCheck.ql@main"
  - uses: "github/codeql/cpp/ql/src/Critical/SizeCheck2.ql@main"
  - uses: "github/codeql/cpp/ql/src/Critical/ReturnStackAllocatedObject.ql@main"
  - uses: "github/codeql/cpp/ql/src/Critical/ReturnValueIgnored.ql@main"
  - uses: "github/codeql/cpp/ql/src/Critical/OverflowCalculated.ql@main"
  - uses: "github/codeql/cpp/ql/src/Critical/OverflowDestination.ql@main"
  - uses: "github/codeql/cpp/ql/src/Critical/OverflowStatic.ql@main"
  # Arithmetic Operations
  - uses: "github/codeql/cpp/ql/src/Likely Bugs/Arithmetic/BadAdditionOverflowCheck.ql@main"
  - uses: "github/codeql/cpp/ql/src/Likely Bugs/Arithmetic/BitwiseSignCheck.ql@main"
  - uses: "github/codeql/cpp/ql/src/Likely Bugs/Arithmetic/IntMultToLong.ql@main"
  - uses: "github/codeql/cpp/ql/src/Likely Bugs/Arithmetic/SignedOverflowCheck.ql@main"
  - uses: "github/codeql/cpp/ql/src/Likely Bugs/Arithmetic/UnsignedGEZero.ql@main"
  - uses: "github/codeql/cpp/ql/src/Likely Bugs/Conversion/ArrayArgSizeMismatch.ql@main"
  - uses: "github/codeql/cpp/ql/src/Likely Bugs/Conversion/CastArrayPointerArithmetic.ql@main"
  # Comments
  # - uses: "github/codeql/cpp/ql/src/Documentation/FixmeComments.ql@main"
  # - uses: "github/codeql/cpp/ql/src/Documentation/TodoComments.ql@main"

  # Custom Queries
  - uses: ./tests/queries
